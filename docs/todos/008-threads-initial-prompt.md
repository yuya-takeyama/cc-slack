---
title: Threads画面に最終セッションの初期プロンプトを表示する
status: draft
---

# 008: Threads画面に最終セッションの初期プロンプトを表示する

## 概要

Web管理コンソールのThreads一覧画面において、各スレッドの最新セッションの初期プロンプトを表示する機能を追加する。これにより、Threads画面でもスレッドの内容を素早く把握できるようになる。

## 背景

現在、セッション一覧画面（SessionList）とスレッドごとのセッション一覧画面（ThreadSessionsPage）では初期プロンプトが表示されるようになったが、Threads一覧画面では表示されていない。ユーザーはスレッドの内容を把握するために、各スレッドをクリックして詳細を確認する必要がある。

## 実装方針

### 1. バックエンド
- [ ] `/api/threads` エンドポイントを修正
  - [ ] 各スレッドの最新セッション情報を含めるようにクエリを更新
  - [ ] レスポンスに `latest_session` オブジェクトを追加（session_id, initial_prompt を含む）

### 2. フロントエンド
- [ ] Threads一覧画面のインターフェースを更新
  - [ ] `Thread` インターフェースに `latest_session?: { session_id: string; initial_prompt?: string }` を追加
- [ ] UI表示の実装
  - [ ] 最新セッションの初期プロンプトを表示（50文字程度で切り詰め）
  - [ ] ホバーで全文表示
  - [ ] セッションがない場合は「No sessions」と表示
  - [ ] 初期プロンプトがNULLの場合は「No prompt available」と表示

### 3. パフォーマンス考慮
- [ ] N+1問題を避けるため、JOINクエリで一度に取得
- [ ] 大量のスレッドがある場合のページネーション対応

## テスト項目
- [ ] 最新セッションの初期プロンプトが正しく表示される
- [ ] セッションがないスレッドの表示が適切
- [ ] 初期プロンプトがNULLのセッションの表示が適切
- [ ] 長い初期プロンプトの切り詰めが正しく動作する